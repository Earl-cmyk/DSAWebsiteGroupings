<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}DSAWebLectures{% endblock %}</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  {% block styles %}{% endblock %}

<style>
/* =====================
   GLOBAL
===================== */
body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

  #bg-grid {
    position: fixed;
    top: 50%;
    left: 50%;
    display: grid;
    transform: translate(-50%, -50%);
    z-index: -10;
    pointer-events: none;
  }

  .grid-cell {
    width: 60px;
    height: 60px;
    background: #0a1a3a;
    transition: background 0.12s linear, box-shadow 0.12s ease, border-color 0.12s ease, transform 0.12s ease;
    box-sizing: border-box;
    border: 2px solid rgba(255,255,255,0.06);
    opacity: 1;
  }

  .grid-cell:hover {
    border-color: rgba(255,255,255,0.12);
    box-shadow: 0 2px 8px rgba(0,0,0,0.35);
    transform: translateY(-2px);
  }

  .grid-cell.active {
    background: #1e90ff;
    border-color: rgba(30,144,255,0.9);
    box-shadow: 0 0 14px rgba(30,144,255,0.35), inset 0 0 6px rgba(255,255,255,0.04);
  }

  @keyframes cellPulse {
    0% { background: #1e90ff; }
    100% { background: #0a1a3a; }
  }

  .grid-cell.pulse {
    animation: cellPulse 0.4s forwards;
  }
/* =====================
   BLUR WHEN MODAL OPEN
===================== */
.page-wrapper.blur {
  filter: blur(6px);
  pointer-events: none;
}

/* =====================
   MODALS
===================== */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  z-index: 999;
}

.auth-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 2rem;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
  z-index: 1000;
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
}

.auth-modal h2 {
  text-align: center;
  margin-bottom: 1.5rem;
}

.auth-modal input {
  width: 100%;
  padding: 12px;
  margin-bottom: 1rem;
  border-radius: 6px;
  border: 1px solid #ddd;
}

.auth-modal button {
  width: 100%;
  padding: 12px;
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
}

.auth-modal button:hover {
  transform: translateY(-1px);
}

.switch {
  text-align: center;
  margin-top: 1rem;
}

.switch a {
  cursor: pointer;
  font-weight: bold;
  color: #667eea;
}

.hidden {
  display: none;
}

.login-btn {
  background: white;
  color: #333;
}

.register-btn {
  background: #667eea;
  color: white;
}

/* =====================
   FOOTER
===================== */
.footer {
  text-align: center;
  padding: 1rem;
  background: #0a1a3a;
  color: #aaa;
}
    /* Desktop: hide burger */
.nav-toggle {
  display: none;
  font-size: 1.8rem;
  background: none;
  border: none;
  color: white;
  cursor: pointer;
}

/* Mobile behavior */
@media (max-width: 768px) {

  .nav-toggle {
    display: block;
  }

  .nav-links {
    position: fixed;
    top: 0;
    right: -260px; /* hidden */
    height: 100vh;
    width: 260px;
    background: rgba(0, 0, 128, 0.9);
    padding: 80px 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    transition: right 0.3s ease;
    z-index: 1200;
  }

  .nav-links.show {
    right: 0;
  }

  .nav-links a {
    font-size: 1.1rem;
  }
}

</style>
</head>

<body>

<!-- =====================
     MODAL OVERLAY
===================== -->
<div id="modal-overlay" class="modal-overlay hidden"></div>

<!-- =====================
     LOGIN MODAL
===================== -->
<div id="login-modal" class="auth-modal hidden">
  <h2>üîê Login</h2>
  <form method="POST" action="{{ url_for('login_page') }}">
    <input name="username" placeholder="Username" required>
    <input name="password" type="password" placeholder="Password" required>
    <button type="submit">Login</button>
  </form>
  <div class="switch">
    No account?
    <a onclick="switchModal('register')">Register</a>
  </div>
</div>

<!-- =====================
     REGISTER MODAL
===================== -->
<div id="register-modal" class="auth-modal hidden">
  <h2>üìù Register</h2>
  <form method="POST" action="{{ url_for('register_page') }}">
    <input name="username" placeholder="Username" required>
    <input name="email" type="email" placeholder="Email" required>
    <input name="password" type="password" placeholder="Password" required>
    <input name="confirm_password" type="password" placeholder="Confirm Password" required>
    <button type="submit">Create Account</button>
  </form>
  <div class="switch">
    Already have an account?
    <a onclick="switchModal('login')">Login</a>
  </div>
</div>

<!-- =====================
     PAGE CONTENT
===================== -->
<div class="page-wrapper">

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="nav-left">
      <a href="{{ url_for('home') }}" class="nav-brand">DSAWebLectures</a>
      <span style="opacity:0.7;font-size:0.9rem;">By: FBOOTLEG</span>
        <button class="nav-toggle" aria-label="Toggle menu">‚ò∞</button>
    </div>

    <nav class="nav-links">
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('lectures') }}">Lectures</a>
      <a href="{{ url_for('collaborators_page') }}">Collaborators</a>
      <a href="{{ url_for('atlas') }}">Atlas</a>
      <a href="{{ url_for('eleccirc') }}">Electrical Circuits</a>
    </nav>

    <div class="nav-auth">
      {% if current_user %}
        <span>üë§ {{ current_user.username }}</span>
        <form method="POST" action="{{ url_for('logout') }}" style="display:inline;">
          <button class="nav-btn">Logout</button>
        </form>
      {% else %}
        <button class="nav-btn login-btn" onclick="openModal('login')">Login</button>
        <button class="nav-btn register-btn" onclick="openModal('register')">Register</button>
      {% endif %}
    </div>
  </header>

  <!-- MAIN -->
  <main class="main-content">
    {% block content %}{% endblock %}
  </main>

</div>

<!-- FOOTER -->
<footer class="footer">
  ¬© 2025 DSAWebLectures ‚Äî Subject to change
</footer>

{% block scripts %}{% endblock %}

<script>
/* =====================
   MODAL LOGIC
===================== */
function openModal(type) {
  document.querySelector('.page-wrapper').classList.add('blur');
  document.getElementById('modal-overlay').classList.remove('hidden');

  if (type === 'login') {
    document.getElementById('login-modal').classList.remove('hidden');
  } else {
    document.getElementById('register-modal').classList.remove('hidden');
  }
}

function closeModal() {
  document.querySelector('.page-wrapper').classList.remove('blur');
  document.getElementById('modal-overlay').classList.add('hidden');
  document.getElementById('login-modal').classList.add('hidden');
  document.getElementById('register-modal').classList.add('hidden');
}

function switchModal(type) {
  document.getElementById('login-modal').classList.add('hidden');
  document.getElementById('register-modal').classList.add('hidden');
  openModal(type);
}

document.getElementById('modal-overlay').addEventListener('click', closeModal);


// GRID BACKGROUND EFFECT
document.addEventListener("DOMContentLoaded", () => {
  const grid = document.getElementById("bg-grid");
  const cellSize = 30;

  function createGrid() {
    grid.innerHTML = "";
    const cols = Math.ceil(window.innerWidth / cellSize) + 2;
    const rows = Math.ceil(window.innerHeight / cellSize) + 2;

    grid.style.gridTemplateColumns = `repeat(${cols}, ${cellSize}px)`;
    grid.style.width = `${cols * cellSize}px`;
    grid.style.height = `${rows * cellSize}px`;

    const total = cols * rows;
    for (let i = 0; i < total; i++) {
      const cell = document.createElement("div");
      cell.classList.add("grid-cell");
      grid.appendChild(cell);
    }

    return { cols, rows, cells: Array.from(grid.children) };
  }

  let { cols, rows, cells } = createGrid();

  function pulseCell(col, row) {
    if (col < 0 || row < 0 || col >= cols || row >= rows) return;
    const idx = row * cols + col;
    const cell = cells[idx];
    if (!cell) return;
    cell.classList.add("active", "pulse");
    setTimeout(() => cell.classList.remove("active"), 120);
    setTimeout(() => cell.classList.remove("pulse"), 400);
  }

  window.addEventListener("mousemove", e => {
    const rect = grid.getBoundingClientRect();
    const col = Math.floor((e.clientX - rect.left) / cellSize);
    const row = Math.floor((e.clientY - rect.top) / cellSize);

    for (let dx = -1; dx <= 1; dx++)
      for (let dy = -1; dy <= 1; dy++)
        pulseCell(col + dx, row + dy);
  });

  window.addEventListener("resize", () => {
    ({ cols, rows, cells } = createGrid());
  });
});
const toggle = document.querySelector('.nav-toggle');
const nav = document.querySelector('.nav-links');

toggle.addEventListener('click', () => {
  nav.classList.toggle('show');
});
</script>

</body>
</html>
